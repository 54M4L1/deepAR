(()=>{var t={330:t=>{class e extends HTMLElement{constructor(t,e){super(),this.attachShadow({mode:"open"}),this.reject=e,this.resolve=t,this.shadowRoot.innerHTML='\n    <style>\n        dialog {\n            background: transparent;\n            border: none;\n            box-shadow: none;\n            outline: none;\n        }\n\n        .puter-dialog-content {\n            border: 3px solid #76c5ff;\n            border-radius: 30px;\n            padding: 80px 20px;\n            background: white;\n            box-shadow: 0 0 9px 1px rgb(0 0 0 / 21%);\n            -webkit-font-smoothing: antialiased;\n            color: #575762;\n            position: relative;\n            background-image: url(\'\');\n            background-repeat: no-repeat;\n            background-position: center center;\n            background-size: 100% 100%;\n            background-color: #fff;\n        }\n\n        dialog * {\n            max-width: 500px;\n            font-family: "Helvetica Neue", HelveticaNeue, Helvetica, Arial, sans-serif;\n        }\n\n        dialog p.about {\n            text-align: center;\n            font-size: 17px;\n            font-family: \'Cairo\';\n            padding: 10px 30px;\n            font-weight: 400;\n            -webkit-font-smoothing: antialiased;\n            color: #404048;\n            box-sizing: border-box;\n        }\n\n        dialog .buttons {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            flex-wrap: wrap;\n            margin-top: 20px;\n            text-align: center;\n            margin-bottom: 20px;\n        }\n\n        .launch-auth-popup-footnote {\n            font-size: 11px;\n            color: #666;\n            margin-top: 10px;\n            position: absolute;\n            left: 0;\n            right: 0;\n            bottom: 10px;\n            text-align: center;\n            margin: 0 10px;\n        }\n\n        dialog .close-btn {\n            position: absolute;\n            right: 15px;\n            top: 10px;\n            font-size: 17px;\n            color: #8a8a8a;\n            cursor: pointer;\n        }\n\n        dialog .close-btn:hover {\n            color: #000;\n        }\n\n            dialog .button {\n    color: #666;\n    background: #eee;\n    font-size: 14px;\n    text-align: center;\n    line-height: 35px;\n    font-family: \'Cairo\';\n    height: 35px;\n    padding: 0 30px;\n    cursor: pointer;\n    border: 1px solid #b9b9b9;\n    border-radius: 4px;\n\n\n        }\n\n        dialog .button:focus-visible {\n            border-color: rgb(118 118 118);\n        }\n\n        dialog .button:active, dialog .button.active, dialog .button.is-active, dialog .button.has-open-contextmenu {\n            text-decoration: none;\n            background-color: #eeeeee;\n            border-color: #cfcfcf;\n            color: #a9a9a9;\n            -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n            -webkit-box-shadow: inset 0 1px 3px rgb(0 0 0 / 20%);\n            box-shadow: inset 0px 2px 3px rgb(0 0 0 / 36%), 0px 1px 0px white;\n        }\n\n        dialog .button.disabled, dialog .button.is-disabled, dialog .button:disabled {\n            top: 0 !important;\n            background: #EEE !important;\n            border: 1px solid #DDD !important;\n            text-shadow: 0 1px 1px white !important;\n            color: #CCC !important;\n            cursor: default !important;\n            appearance: none !important;\n            pointer-events: none;\n        }\n\n        dialog .button-action.disabled, dialog .button-action.is-disabled, dialog .button-action:disabled {\n            background: #55a975 !important;\n            border: 1px solid #60ab7d !important;\n            text-shadow: none !important;\n            color: #CCC !important;\n        }\n\n        dialog .button-primary.disabled, dialog .button-primary.is-disabled, dialog .button-primary:disabled {\n            background: #8fc2e7 !important;\n            border: 1px solid #98adbd !important;\n            text-shadow: none !important;\n            color: #f5f5f5 !important;\n        }\n\n        dialog .button-block {\n            width: 100%;\n        }\n\n        dialog .button-primary {\n            border-color: #088ef0;\n            background: -webkit-gradient(linear, left top, left bottom, from(#34a5f8), to(#088ef0));\n            background: linear-gradient(#34a5f8, #088ef0);\n            color: white;\n        }\n\n        dialog .button-danger {\n            border-color: #f00808;\n            background: -webkit-gradient(linear, left top, left bottom, from(#f83434), to(#f00808));\n            background: linear-gradient(#f83434, #f00808);\n            color: white;\n        }\n\n        dialog .button-primary:active, dialog .button-primary.active, dialog .button-primary.is-active, dialog .button-primary-flat:active, dialog .button-primary-flat.active, dialog .button-primary-flat.is-active {\n            background-color: #2798eb;\n            border-color: #2798eb;\n            color: #bedef5;\n        }\n\n        dialog .button-action {\n            border-color: #08bf4e;\n            background: -webkit-gradient(linear, left top, left bottom, from(#29d55d), to(#1ccd60));\n            background: linear-gradient(#29d55d, #1ccd60);\n            color: white;\n        }\n\n        dialog .button-action:active, dialog .button-action.active, dialog .button-action.is-active, dialog .button-action-flat:active, dialog .button-action-flat.active, dialog .button-action-flat.is-active {\n            background-color: #27eb41;\n            border-color: #27eb41;\n            color: #bef5ca;\n        }\n\n        dialog .button-giant {\n            font-size: 28px;\n            height: 70px;\n            line-height: 70px;\n            padding: 0 70px;\n        }\n\n        dialog .button-jumbo {\n            font-size: 24px;\n            height: 60px;\n            line-height: 60px;\n            padding: 0 60px;\n        }\n\n        dialog .button-large {\n            font-size: 20px;\n            height: 50px;\n            line-height: 50px;\n            padding: 0 50px;\n        }\n\n        dialog .button-normal {\n            font-size: 16px;\n            height: 40px;\n            line-height: 38px;\n            padding: 0 40px;\n        }\n\n        dialog .button-small {\n            height: 30px;\n            line-height: 29px;\n            padding: 0 30px;\n        }\n\n        dialog .button-tiny {\n            font-size: 9.6px;\n            height: 24px;\n            line-height: 24px;\n            padding: 0 24px;\n        }\n\n        #launch-auth-popup {\n            margin-left: 10px;\n            width: 200px;\n            font-weight: 500;\n            font-size: 15px;\n        }\n\n        dialog .button-auth {\n            margin-bottom: 10px;\n        }\n\n        dialog a, dialog a:visited {\n            color: rgb(35 155 235);\n            text-decoration: none;\n        }\n\n        dialog a:hover {\n           color: rgb(0 0 0);\n        }\n\n        @media (max-width: 480px) {\n            .puter-dialog-content {\n                padding: 50px 20px;\n            }\n\n            dialog .buttons {\n                flex-direction: column-reverse;\n            }\n\n            dialog p.about {\n                padding: 10px 0;\n            }\n\n            dialog .button-auth {\n                width: 100% !important;\n                margin: 0 !important;\n                margin-bottom: 10px !important;\n            }\n        }\n    </style>\n\n    <dialog>\n    <div class="puter-dialog-content">\n        <span class="close-btn">&#x2715</span>\n        <a target="_blank" style="font-family: \'Orbitron\';display: block;font-size: x-large;text-align: center;"">\nDeepSinker by Sam        </a>\n        <p class="about">\u064a\u0633\u062a\u062e\u062f\u0645 \u0647\u0630\u0627 \u0627\u0644\u0645\u0648\u0642\u0639 SinkerAI \u0644\u062a\u0642\u062f\u064a\u0645 \u0645\u064a\u0632\u0627\u062a \u0627\u0644\u0630\u0643\u0627\u0621 \u0627\u0644\u0627\u0635\u0637\u0646\u0627\u0639\u064a \u0628\u0634\u0643\u0644 \u0622\u0645\u0646 \u0648\u062e\u0627\u0635.</p>\n        <div class="buttons">\n            <button class="button button-primary button-auth" id="launch-auth-popup" style="margin-left:10px;">\u0627\u0633\u062a\u0645\u0631\u0627\u0631</button>\n        </div>\n        <p style="text-align: center; margin-top: -15px; font-size: 14px;">\u0645\u062f\u0639\u0648\u0645 \u0628\u0648\u0627\u0633\u0637\u0629 <a href="https://cdn.jsdelivr.net/gh/54M4L1/SinkerJS@main/" target="_blank">Sinker.js</a></p>\n        <p class="launch-auth-popup-footnote">\u0628\u0627\u0644\u0646\u0642\u0631 \u0639\u0644\u0649 "\u0627\u0633\u062a\u0645\u0631\u0627\u0631" \u0623\u0646\u062a \u062a\u0648\u0627\u0641\u0642 \u0639\u0644\u0649 <a href="https://puter.com/?embedded_in_popup=true&request_auth=true" target="_blank">\u0634\u0631\u0648\u0637 \u0627\u0644\u062e\u062f\u0645\u0629</a> \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0646\u0627</p>\n    </div>\n</dialog>\n\n',this.messageListener=async t=>{"puter.token"===t.data.msg&&(this.close(),puter.setAuthToken(t.data.token),puter.setAppID(t.data.app_uid),window.removeEventListener("message",this.messageListener),puter.puterAuthState.authGranted=1,this.resolve(),puter.onAuth&&"function"==typeof puter.onAuth&&puter.getUser().then((t=>{puter.onAuth(t)})),puter.puterAuthState.isPromptOpen=0,puter.puterAuthState.resolver&&(puter.puterAuthState.authGranted?puter.puterAuthState.resolver.resolve():puter.puterAuthState.resolver.reject(),puter.puterAuthState.resolver=null))}}cancelListener=()=>{this.close(),window.removeEventListener("message",this.messageListener),puter.puterAuthState.authGranted=0,puter.puterAuthState.isPromptOpen=0,this.reject(new Error("User cancelled the authentication")),puter.puterAuthState.resolver&&(puter.puterAuthState.resolver.reject(new Error("User cancelled the authentication")),puter.puterAuthState.resolver=null)};connectedCallback(){this.shadowRoot.querySelector("#launch-auth-popup").addEventListener("click",(()=>{var t=screen.width/2-300,e=screen.height/2-200;window.open(puter.defaultGUIOrigin+"/?embedded_in_popup=true&request_auth=true","Puter","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=400, top="+e+", left="+t)})),window.addEventListener("message",this.messageListener),this.shadowRoot.querySelector("#launch-auth-popup-cancel").addEventListener("click",this.cancelListener),this.shadowRoot.querySelector(".close-btn").addEventListener("click",this.cancelListener)}open(){this.shadowRoot.querySelector("dialog").showModal()}close(){this.shadowRoot.querySelector("dialog").close()}}customElements.define("puter-dialog",e),t.exports=e}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.t?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:1,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{async function t(t){if("blob"===t.responseType){const e=t.getResponseHeader("content-type");if(e.startsWith("application/json")){const e=await t.response.text();try{return JSON.parse(e)}catch(t){return e}}else if(e.startsWith("application/octet-stream"))return t.response;return{success:1,result:t.response}}const e=t.responseText;try{return JSON.parse(e)}catch(t){return e}}function e(t,e,n,i="post",s="application/json;charset=UTF-8",r=void 0){const o=new XMLHttpRequest;return o.open(i,e+t,1),o.setRequestHeader("Authorization","Bearer "+n),o.setRequestHeader("Content-Type",s),o.responseType=r,o}function i(t,e,n){return t&&"function"==typeof t&&t(n),e(n)}function s(e,n,s,r,o){e.addEventListener("load",(function(e){return async function(e,n,i,s,r){const o=await t(r);return 401===r.status?(n&&"function"==typeof n&&n({status:401,message:"Unauthorized"}),s({status:401,message:"Unauthorized"})):200!==r.status?(n&&"function"==typeof n&&n(o),s(o)):(0==o.success&&"permission_denied"===o.error?.code&&(await puter.ui.requestPermission({permission:"driver:puter-image-generation:generate"})).granted,e&&"function"==typeof e&&e(o),i(o))}(n,s,r,o,this)})),e.addEventListener("error",(function(t){return i(s,o,this)}))}const r=()=>{};class o{static callback(t){return t&&"function"==typeof t?t:void 0}}function a(t,e,n,i={}){return async function(...s){let r={},o={};return 1!==s.length||"object"!=typeof s[0]||Array.isArray(s[0])?(t.forEach(((t,e)=>{r[t]=s[e]})),o={success:s[t.length],error:s[t.length+1]}):(r={...s[0]},o={success:r.success,error:r.error},delete r.success,delete r.error),i.preprocess&&"function"==typeof i.preprocess&&(r=i.preprocess(r)),await async function(t,e,n,i,s){const r=new h;return c(t,r.resolve.bind(r),r.reject.bind(r),e,n,i,void 0,void 0,s),await r}(o,e,n,r,i)}}async function c(n={},s,a,h,u,p,l,d="application/json;charset=UTF-8",f={}){if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){return a({error:{code:"auth_canceled",message:"Authentication canceled"}})}const m=o.callback(n.success)??r,g=o.callback(n.error)??r,b=e("/drivers/call",puter.APIOrigin,puter.authToken,"POST",d);f.responseType&&(b.responseType=f.responseType),b.addEventListener("load",(async function(e){const i=await t(e.target);if(401===e.status||"token_auth_failed"===i?.code){if("token_auth_failed"===i?.code&&"web"===puter.env)try{puter.resetAuthToken(),await puter.ui.authenticateWithPuter()}catch(t){return a({error:{code:"auth_canceled",message:"Authentication canceled"}})}return g&&"function"==typeof g&&g({status:401,message:"Unauthorized"}),a({status:401,message:"Unauthorized"})}if(e.status&&200!==e.status)return g(i),a(i);{if(0==i.success&&"permission_denied"===i.error?.code)return(await puter.ui.requestPermission({permission:"driver:"+h+":"+u})).granted?c(n,s,a,h,u,p,l,d,f):(g(i),a(i));if(0==i.success)return g(i),a(i);let t=void 0!==i.result?i.result:i;return f.transform&&(t=await f.transform(t)),s.success&&m(t),s(t)}})),b.addEventListener("error",(function(t){return i(g,a,this)})),b.send(JSON.stringify({interface:h,test_mode:f?.test_mode,method:u,args:p}))}class h{static STATUS_PENDING={};static STATUS_RUNNING={};static STATUS_DONE={};constructor(){this.status_=this.constructor.STATUS_PENDING,this.donePromise=new Promise(((t,e)=>{this.doneResolve=t,this.doneReject=e}))}get status(){return this.status_}set status(t){this.status_=t,t===this.constructor.STATUS_DONE&&this.doneResolve()}resolve(t){this.status_=this.constructor.STATUS_DONE,this.doneResolve(t)}awaitDone(){return this.donePromise}then(t,e){return this.donePromise.then(t,e)}reject(t){this.status_=this.constructor.STATUS_DONE,this.doneReject(t)}onComplete(t){return this.then(t)}}async function u(t){const e=new h,n=new FileReader;return n.onloadend=()=>e.resolve(n.result),n.readAsDataURL(t),await e}function p(t){return new Promise(((e,n)=>{const i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(t){n(t)},i.readAsDataURL(t)}))}const l=class{constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n}setAuthToken(t){this.authToken=t}setAPIOrigin(t){this.APIOrigin=t}user=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise(((t,i)=>{const r=e("/whoami",this.APIOrigin,this.authToken,"get");s(r,n.success,n.error,t,i),r.send()}))};version=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise(((t,i)=>{const r=e("/version",this.APIOrigin,this.authToken,"get");s(r,n.success,n.error,t,i),r.send()}))}},d=Object.create(null);d.open="0",d.close="1",d.ping="2",d.pong="3",d.message="4",d.upgrade="5",d.noop="6";const f=Object.create(null);Object.keys(d).forEach((t=>{f[d[t]]=t}));const m={type:"error",data:"parser error"},g="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),b="function"==typeof ArrayBuffer,w=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,y=({type:t,data:e},n,i)=>g&&e instanceof Blob?n?i(e):v(e,i):b&&(e instanceof ArrayBuffer||w(e))?n?i(e):v(new Blob([e]),i):i(d[t]+(e||"")),v=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+(t||""))},n.readAsDataURL(t)};function k(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let _;const x="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<64;t++)x["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;const A="function"==typeof ArrayBuffer,P=(t,e)=>{if("string"!=typeof t)return{type:"message",data:I(t,e)};const n=t.charAt(0);return"b"===n?{type:"message",data:O(t.substring(1),e)}:f[n]?t.length>1?{type:f[n],data:t.substring(1)}:{type:f[n]}:m},O=(t,e)=>{if(A){const n=(t=>{let e,n,i,s,r,o=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);const h=new ArrayBuffer(o),u=new Uint8Array(h);for(e=0;e<a;e+=4)n=x[t.charCodeAt(e)],i=x[t.charCodeAt(e+1)],s=x[t.charCodeAt(e+2)],r=x[t.charCodeAt(e+3)],u[c++]=n<<2|i>>4,u[c++]=(15&i)<<4|s>>2,u[c++]=(3&s)<<6|63&r;return h})(t);return I(n,e)}return{base64:1,data:t}},I=(t,e)=>"blob"===e?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,j=String.fromCharCode(30);let E;function S(t){return t.reduce(((t,e)=>t+e.length),0)}function D(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let i=0;for(let s=0;s<e;s++)n[s]=t[0][i++],i===t[0].length&&(t.shift(),i=0);return t.length&&i<t[0].length&&(t[0]=t[0].slice(i)),n}function U(t){if(t)return function(t){for(var e in U.prototype)t[e]=U.prototype[e];return t}(t)}U.prototype.on=U.prototype.addEventListener=function(t,e){return this.i=this.i||{},(this.i["$"+t]=this.i["$"+t]||[]).push(e),this},U.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},U.prototype.off=U.prototype.removeListener=U.prototype.removeAllListeners=U.prototype.removeEventListener=function(t,e){if(this.i=this.i||{},0==arguments.length)return this.i={},this;var n,i=this.i["$"+t];if(!i)return this;if(1==arguments.length)return delete this.i["$"+t],this;for(var s=0;s<i.length;s++)if((n=i[s])===e||n.fn===e){i.splice(s,1);break}return 0===i.length&&delete this.i["$"+t],this},U.prototype.emit=function(t){this.i=this.i||{};for(var e=new Array(arguments.length-1),n=this.i["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){i=0;for(var s=(n=n.slice(0)).length;i<s;++i)n[i].apply(this,e)}return this},U.prototype.emitReserved=U.prototype.emit,U.prototype.listeners=function(t){return this.i=this.i||{},this.i["$"+t]||[]},U.prototype.hasListeners=function(t){return!!this.listeners(t).length};const T="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function C(t,...e){return e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{})}const N=T.setTimeout,z=T.clearTimeout;function $(t,e){e.useNativeTimers?(t.setTimeoutFn=N.bind(T),t.clearTimeoutFn=z.bind(T)):(t.setTimeoutFn=T.setTimeout.bind(T),t.clearTimeoutFn=T.clearTimeout.bind(T))}class L extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}}class R extends U{constructor(t){super(),this.writable=0,$(this,t),this.opts=t,this.query=t.query,this.socket=t.socket}onError(t,e,n){return super.emitReserved("error",new L(t,e,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=1,super.emitReserved("open")}onData(t){const e=P(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this.h()+this.u()+this.opts.path+this.p(e)}h(){const t=this.opts.hostname;return-1===t.indexOf(":")?t:"["+t+"]"}u(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}p(t){const e=function(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}(t);return e.length?"?"+e:""}}const F="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),B={};let M,q=0,W=0;function J(t){let e="";do{e=F[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function H(){const t=J(+new Date);return t!==M?(q=0,M=t):t+"."+J(q++)}for(;W<64;W++)B[F[W]]=W;let X=0;try{X="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(d){}const V=X;function K(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||V))return new XMLHttpRequest}catch(t){}if(!e)try{return new(T[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function Y(){}const G=null!=new K({xdomain:0}).responseType;class Q extends U{constructor(t,e){super(),$(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.data=void 0!==e.data?e.data:null,this.create()}create(){var t;const e=C(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd;const n=this.xhr=new K(e);try{n.open(this.method,this.uri,1);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(1);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&n.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{n.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this.opts.cookieJar)||void 0===t||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var t;3===n.readyState&&(null===(t=this.opts.cookieJar)||void 0===t||t.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof n.status?n.status:0)}),0))},n.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=Q.requestsCount++,Q.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(1)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=Y,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Q.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function Z(){for(let t in Q.requests)Q.requests.hasOwnProperty(t)&&Q.requests[t].abort()}Q.requestsCount=0,Q.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Z):"function"==typeof addEventListener&&addEventListener("onpagehide"in T?"pagehide":"unload",Z,0));const tt="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),et=T.WebSocket||T.MozWebSocket,nt="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),it={websocket:class extends R{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=nt?{}:C(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=nt?new et(t,e,n):e?new et(t,e):new et(t)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws.l.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=0;for(let e=0;e<t.length;e++){const n=t[e],i=e===t.length-1;y(n,this.supportsBinary,(t=>{try{this.ws.send(t)}catch(t){}i&&tt((()=>{this.writable=1,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=H()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}check(){return!!et}},webtransport:class extends R{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((t=>{const e=function(t,e){E||(E=new TextDecoder);const n=[];let i=0,s=-1,r=0;return new TransformStream({transform(o,a){for(n.push(o);;){if(0===i){if(S(n)<1)break;const t=D(n,1);r=!(128&~t[0]),s=127&t[0],i=s<126?3:126===s?1:2}else if(1===i){if(S(n)<2)break;const t=D(n,2);s=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),i=3}else if(2===i){if(S(n)<8)break;const t=D(n,8),e=new DataView(t.buffer,t.byteOffset,t.length),r=e.getUint32(0);if(r>Math.pow(2,21)-1){a.enqueue(m);break}s=r*Math.pow(2,32)+e.getUint32(4),i=3}else{if(S(n)<s)break;const t=D(n,s);a.enqueue(P(r?t:E.decode(t),e)),i=0}if(0===s||s>t){a.enqueue(m);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(e).getReader(),i=new TransformStream({transform(t,e){!function(t,e){g&&t.data instanceof Blob?t.data.arrayBuffer().then(k).then(e):b&&(t.data instanceof ArrayBuffer||w(t.data))?e(k(t.data)):y(t,0,(t=>{_||(_=new TextEncoder),e(_.encode(t))}))}(t,(n=>{const i=n.length;let s;if(i<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,i);else if(i<65536){s=new Uint8Array(3);const t=new DataView(s.buffer);t.setUint8(0,126),t.setUint16(1,i)}else{s=new Uint8Array(9);const t=new DataView(s.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(i))}t.data&&"string"!=typeof t.data&&(s[0]|=128),e.enqueue(s),e.enqueue(n)}))}});i.readable.pipeTo(t.writable),this.writer=i.writable.getWriter();const s=()=>{n.read().then((({done:t,value:e})=>{t||(this.onPacket(e),s())})).catch((t=>{}))};s();const r={type:"open"};this.query.sid&&(r.data=`{"sid":"${this.query.sid}"}`),this.writer.write(r).then((()=>this.onOpen()))}))})))}write(t){this.writable=0;for(let e=0;e<t.length;e++){const n=t[e],i=e===t.length-1;this.writer.write(n).then((()=>{i&&tt((()=>{this.writable=1,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var t;null===(t=this.transport)||void 0===t||t.close()}},polling:class extends R{constructor(t){if(super(t),this.polling=0,"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port}const e=t&&t.forceBase64;this.supportsBinary=G&&!e,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=1,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const n=t.split(j),i=[];for(let t=0;t<n.length;t++){const s=P(n[t],e);if(i.push(s),"error"===s.type)break}return i})(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),0;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=0,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=0,((t,e)=>{const n=t.length,i=new Array(n);let s=0;t.forEach(((t,r)=>{y(t,0,(t=>{i[r]=t,++s===n&&e(i.join(j))}))}))})(t,(t=>{this.doWrite(t,(()=>{this.writable=1,this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return 0!=this.opts.timestampRequests&&(e[this.opts.timestampParam]=H()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)}request(t={}){return Object.assign(t,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Q(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}},st=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,rt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ot(t){const e=t,n=t.indexOf("["),i=t.indexOf("]");-1!=n&&-1!=i&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));let s=st.exec(t||""),r={},o=14;for(;o--;)r[rt[o]]=s[o]||"";return-1!=n&&-1!=i&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=1),r.pathNames=function(t,e){const n=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.slice(0,1)&&0!==e.length||n.splice(0,1),"/"==e.slice(-1)&&n.splice(n.length-1,1),n}(0,r.path),r.queryKey=function(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,i){e&&(n[e]=i)})),n}(0,r.query),r}class at extends U{constructor(t,e={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],t&&"object"==typeof t&&(e=t,t=null),t?(t=ot(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=ot(e.host).host),$(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:0,withCredentials:0,upgrade:1,timestampParam:"t",rememberUpgrade:0,addTrailingSlash:1,rejectUnauthorized:1,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},n=t.split("&");for(let t=0,i=n.length;t<i;t++){let i=n[t].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,0)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,0))),this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new it[t](n)}open(){let t;if(this.opts.rememberUpgrade&&at.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let e=this.createTransport(t),n=0;at.priorWebsocketSuccess=0;const i=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=1,this.emitReserved("upgrading",e),!e)return;at.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=0,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function s(){n||(n=1,h(),e.close(),e=null)}const r=t=>{const n=new Error("probe error: "+t);n.transport=e.name,s(),this.emitReserved("upgradeError",n)};function o(){r("transport closed")}function a(){r("socket closed")}function c(t){e&&t.name!==e.name&&s()}const h=()=>{e.removeListener("open",i),e.removeListener("error",r),e.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};e.once("open",i),e.once("error",r),e.once("close",o),this.once("close",a),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((()=>{n||e.open()}),200):e.open()}onOpen(){if(this.readyState="open",at.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(t+="string"==typeof(e=i)?function(t){let e=0,n=0;for(let i=0,s=t.length;i<s;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}var e;return this.writeBuffer}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=0!=n.compress;const s={type:t,data:e,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():t()})):this.upgrading?n():t()),this}onError(t){at.priorWebsocketSuccess=0,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,0),removeEventListener("offline",this.offlineEventListener,0)),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const i=t.length;for(;n<i;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}at.protocol=4;const ct="function"==typeof ArrayBuffer,ht=Object.prototype.toString,ut="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===ht.call(Blob),pt="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===ht.call(File);function lt(t){return ct&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||ut&&t instanceof Blob||pt&&t instanceof File}function dt(t,e){if(!t||"object"!=typeof t)return 0;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(dt(t[e]))return 1;return 0}if(lt(t))return 1;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return dt(t.toJSON(),1);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&dt(t[e]))return 1;return 0}function ft(t){const e=[],n=t.data,i=t;return i.data=mt(n,e),i.attachments=e.length,{packet:i,buffers:e}}function mt(t,e){if(!t)return t;if(lt(t)){const n={m:1,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=mt(t[i],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=mt(t[i],e));return n}return t}function gt(t,e){return t.data=bt(t.data,e),delete t.attachments,t}function bt(t,e){if(!t)return t;if(t&&1==t.m){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=bt(t[n],e);else if("object"==typeof t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=bt(t[n],e));return t}const wt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var yt;function vt(t){return"[object Object]"===Object.prototype.toString.call(t)}!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(yt||(yt={}));class kt extends U{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const n=e.type===yt.BINARY_EVENT;n||e.type===yt.BINARY_ACK?(e.type=n?yt.EVENT:yt.ACK,this.reconstructor=new _t(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!lt(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===yt[n.type])throw new Error("unknown packet type "+n.type);if(n.type===yt.BINARY_EVENT||n.type===yt.BINARY_ACK){const i=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const s=t.substring(i,e);if(s!=Number(s)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(s)}if("/"===t.charAt(e+1)){const i=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(i,e)}else n.nsp="/";const i=t.charAt(e+1);if(""!==i&&Number(i)==i){const i=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(!kt.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return 0}}static isPayloadValid(t,e){switch(t){case yt.CONNECT:return vt(e);case yt.DISCONNECT:return void 0===e;case yt.CONNECT_ERROR:return"string"==typeof e||vt(e);case yt.EVENT:case yt.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===wt.indexOf(e[0]));case yt.ACK:case yt.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class _t{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=gt(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var xt=Object.freeze({__proto__:null,protocol:5,get PacketType(){return yt},Encoder:class{constructor(t){this.replacer=t}encode(t){return t.type!==yt.EVENT&&t.type!==yt.ACK||!dt(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===yt.EVENT?yt.BINARY_EVENT:yt.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==yt.BINARY_EVENT&&t.type!==yt.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=ft(t),n=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(n),i}},Decoder:kt});function At(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Pt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ot extends U{constructor(t,e,n){super(),this.connected=0,this.recovered=0,this.receiveBuffer=[],this.sendBuffer=[],this.v=[],this.k=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this._=Object.assign({},n),this.io.A&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[At(t,"open",this.onopen.bind(this)),At(t,"packet",this.onpacket.bind(this)),At(t,"error",this.onerror.bind(this)),At(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io.P||this.io.open(),"open"===this.io.O&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Pt.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this.I(e),this;const n={type:yt.EVENT,data:e,options:{}};if(n.options.compress=0!=this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,i=e.pop();this.j(t,i),n.id=t}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}j(t,e){var n;const i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._.ackTimeout;if(void 0===i)return void(this.acks[t]=e);const s=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),i);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...t])}}emitWithAck(t,...e){const n=void 0!==this.flags.timeout||void 0!==this._.ackTimeout;return new Promise(((i,s)=>{e.push(((t,e)=>n?t?s(t):i(e):i(t))),this.emit(t,...e)}))}I(t){let e;"function"==typeof t[t.length-1]&&(e=t.pop());const n={id:this.k++,tryCount:0,pending:0,args:t,flags:Object.assign({fromQueue:1},this.flags)};t.push(((t,...i)=>{if(n===this.v[0])return null!==t?n.tryCount>this._.retries&&(this.v.shift(),e&&e(t)):(this.v.shift(),e&&e(null,...i)),n.pending=0,this.S()})),this.v.push(n),this.S()}S(t=0){if(!this.connected||0===this.v.length)return;const e=this.v[0];e.pending&&!t||(e.pending=1,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io.D(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this.U(t)})):this.U(this.auth)}U(t){this.packet({type:yt.CONNECT,data:this.T?Object.assign({pid:this.T,offset:this.C},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=0,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case yt.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case yt.EVENT:case yt.BINARY_EVENT:this.onevent(t);break;case yt.ACK:case yt.BINARY_ACK:this.onack(t);break;case yt.DISCONNECT:this.ondisconnect();break;case yt.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this.N&&this.N.length){const e=this.N.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t),this.T&&t.length&&"string"==typeof t[t.length-1]&&(this.C=t[t.length-1])}ack(t){const e=this;let n=0;return function(...i){n||(n=1,e.packet({type:yt.ACK,id:t,data:i}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t,e){this.id=t,this.recovered=e&&this.T===e,this.T=e,this.connected=1,this.emitBuffered(),this.emitReserved("connect"),this.S(1)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io.$(this)}disconnect(){return this.connected&&this.packet({type:yt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=1,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this.N=this.N||[],this.N.push(t),this}prependAny(t){return this.N=this.N||[],this.N.unshift(t),this}offAny(t){if(!this.N)return this;if(t){const e=this.N;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this.N=[];return this}listenersAny(){return this.N||[]}onAnyOutgoing(t){return this.L=this.L||[],this.L.push(t),this}prependAnyOutgoing(t){return this.L=this.L||[],this.L.unshift(t),this}offAnyOutgoing(t){if(!this.L)return this;if(t){const e=this.L;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this.L=[];return this}listenersAnyOutgoing(){return this.L||[]}notifyOutgoingListeners(t){if(this.L&&this.L.length){const e=this.L.slice();for(const n of e)n.apply(this,t.data)}}}function It(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}It.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+n:t-n}return 0|Math.min(t,this.max)},It.prototype.reset=function(){this.attempts=0},It.prototype.setMin=function(t){this.ms=t},It.prototype.setMax=function(t){this.max=t},It.prototype.setJitter=function(t){this.jitter=t};class jt extends U{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,$(this,e),this.reconnection(0!=e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new It({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.O="closed",this.uri=t;const i=e.parser||xt;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.A=0!=e.autoConnect,this.A&&this.open()}reconnection(t){return arguments.length?(this.R=!!t,this):this.R}reconnectionAttempts(t){return void 0===t?this.F:(this.F=t,this)}reconnectionDelay(t){var e;return void 0===t?this.B:(this.B=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this.M:(this.M=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this.q:(this.q=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this.W=t,this):this.W}maybeReconnectOnOpen(){!this.P&&this.R&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this.O.indexOf("open"))return this;this.engine=new at(this.uri,this.opts);const e=this.engine,n=this;this.O="opening",this.skipReconnect=0;const i=At(e,"open",(function(){n.onopen(),t&&t()})),s=e=>{this.cleanup(),this.O="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()},r=At(e,"error",s);if(0!=this.W){const t=this.W,n=this.setTimeoutFn((()=>{i(),s(new Error("timeout")),e.close()}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(i),this.subs.push(r),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this.O="open",this.emitReserved("open");const t=this.engine;this.subs.push(At(t,"ping",this.onping.bind(this)),At(t,"data",this.ondata.bind(this)),At(t,"error",this.onerror.bind(this)),At(t,"close",this.onclose.bind(this)),At(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){tt((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n?this.A&&!n.active&&n.connect():(n=new Ot(this,t,e),this.nsps[t]=n),n}$(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return;this.J()}D(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}J(){this.skipReconnect=1,this.P=0,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this.J()}onclose(t,e){this.cleanup(),this.backoff.reset(),this.O="closed",this.emitReserved("close",t,e),this.R&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this.P||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this.F)this.backoff.reset(),this.emitReserved("reconnect_failed"),this.P=0;else{const e=this.backoff.duration();this.P=1;const n=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t.P=0,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const t=this.backoff.attempts;this.P=0,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Et={};function St(t,e){"object"==typeof t&&(e=t,t=void 0);const n=function(t,e="",n){let i=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),i=ot(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const s=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(n&&n.port===i.port?"":":"+i.port),i}(t,(e=e||{}).path||"/socket.io"),i=n.source,s=n.id,r=n.path,o=Et[s]&&r in Et[s].nsps;let a;return e.forceNew||e["force new connection"]||0==e.multiplex||o?a=new jt(i,e):(Et[s]||(Et[s]=new jt(i,e)),a=Et[s]),n.query&&!e.query&&(e.query=n.queryKey),a.socket(n.path,e)}Object.assign(St,{Manager:jt,Socket:Ot,io:St,connect:St});const Dt=47;function Ut(t){return t===Dt}function Tt(t,e,n,i){let s="",r=0,o=-1,a=0,c=0;for(let h=0;h<=t.length;++h){if(h<t.length)c=t.charCodeAt(h);else{if(i(c))break;c=Dt}if(i(c)){if(o===h-1||1===a);else if(2===a){if(s.length<2||2!==r||46!==s.charCodeAt(s.length-1)||46!==s.charCodeAt(s.length-2)){if(s.length>2){const t=s.lastIndexOf(n);-1===t?(s="",r=0):(s=s.slice(0,t),r=s.length-1-s.lastIndexOf(s,n)),o=h,a=0;continue}if(0!==s.length){s="",r=0,o=h,a=0;continue}}e&&(s+=s.length>0?`${n}..`:"..",r=2)}else s.length>0?s+=`${n}${t.slice(o+1,h)}`:s=t.slice(o+1,h),r=h-o-1;o=h,a=0}else 46===c&&-1!==a?++a:a=-1}return s}const Ct={resolve(...t){let e="",n=0;for(let i=t.length-1;i>=-1&&!n;i--){const s=i>=0?t[i]:"/";0!==s.length&&(e=`${s}/${e}`,n=s.charCodeAt(0)===Dt)}return e=Tt(e,!n,"/",Ut),n?`/${e}`:e.length>0?e:"."},normalize(t){if(0===t.length)return".";const e=t.charCodeAt(0)===Dt,n=t.charCodeAt(t.length-1)===Dt;return 0===(t=Tt(t,!e,"/",Ut)).length?e?"/":n?"./":".":(n&&(t+="/"),e?`/${t}`:t)},isAbsolute:t=>t.length>0&&t.charCodeAt(0)===Dt,join(...t){if(0===t.length)return".";let e;for(let n=0;n<t.length;++n){const i=t[n];i.length>0&&(void 0===e?e=i:e+=`/${i}`)}return void 0===e?".":Ct.normalize(e)},relative(t,e){if(t===e)return"";if((t=Ct.resolve(t))===(e=Ct.resolve(e)))return"";const n=t.length,i=n-1,s=e.length-1,r=i<s?i:s;let o=-1,a=0;for(;a<r;a++){const n=t.charCodeAt(1+a);if(n!==e.charCodeAt(1+a))break;n===Dt&&(o=a)}if(a===r)if(s>r){if(e.charCodeAt(1+a)===Dt)return e.slice(1+a+1);if(0===a)return e.slice(1+a)}else i>r&&(t.charCodeAt(1+a)===Dt?o=a:0===a&&(o=0));let c="";for(a=1+o+1;a<=n;++a)a!==n&&t.charCodeAt(a)!==Dt||(c+=0===c.length?"..":"/..");return`${c}${e.slice(1+o)}`},toNamespacedPath:t=>t,dirname(t){if(0===t.length)return".";const e=t.charCodeAt(0)===Dt;let n=-1,i=1;for(let e=t.length-1;e>=1;--e)if(t.charCodeAt(e)===Dt){if(!i){n=e;break}}else i=0;return-1===n?e?"/":".":e&&1===n?"//":t.slice(0,n)},basename(t,e){let n=0,i=-1,s=1;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e===t)return"";let r=e.length-1,o=-1;for(let a=t.length-1;a>=0;--a){const c=t.charCodeAt(a);if(c===Dt){if(!s){n=a+1;break}}else-1===o&&(s=0,o=a+1),r>=0&&(c===e.charCodeAt(r)?-1==--r&&(i=a):(r=-1,i=o))}return n===i?i=o:-1===i&&(i=t.length),t.slice(n,i)}for(let e=t.length-1;e>=0;--e)if(t.charCodeAt(e)===Dt){if(!s){n=e+1;break}}else-1===i&&(s=0,i=e+1);return-1===i?"":t.slice(n,i)},extname(t){let e=-1,n=0,i=-1,s=1,r=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a!==Dt)-1===i&&(s=0,i=o+1),46===a?-1===e?e=o:1!==r&&(r=1):-1!==e&&(r=-1);else if(!s){n=o+1;break}}return-1===e||-1===i||0===r||1===r&&e===i-1&&e===n+1?"":t.slice(e,i)},format:function(t,e){validateObject(e,"pathObject");const n=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return n?n===e.root?`${n}${i}`:`${n}${t}${i}`:i}.bind(null,"/"),parse(t){const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;const n=t.charCodeAt(0)===Dt;let i;n?(e.root="/",i=1):i=0;let s=-1,r=0,o=-1,a=1,c=t.length-1,h=0;for(;c>=i;--c){const e=t.charCodeAt(c);if(e!==Dt)-1===o&&(a=0,o=c+1),46===e?-1===s?s=c:1!==h&&(h=1):-1!==s&&(h=-1);else if(!a){r=c+1;break}}if(-1!==o){const i=0===r&&n?1:r;-1===s||0===h||1===h&&s===o-1&&s===r+1?e.base=e.name=t.slice(i,o):(e.name=t.slice(i,s),e.base=t.slice(i,o),e.ext=t.slice(s,o))}return r>0?e.dir=t.slice(0,r-1):n&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null},Nt=Ct,zt=t=>("gui"===puter.env||(t||(t="."),t&&(t.startsWith("/")||t.startsWith("~")||!puter.appID)||(t=Nt.join("~/AppData",puter.appID,t))),t),$t=async function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{path:t[0],success:t[1],error:t[2]},new Promise((async(t,i)=>{if(!n.path)throw new Error({code:"NO_PATH",message:"No path provided."});if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}const r=e("/readdir",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i),r.send(JSON.stringify({path:zt(n.path)}))}))},Lt=async function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{path:t[0],options:"object"==typeof t[1]?t[1]:{},success:"object"==typeof t[1]?t[2]:t[1],error:"object"==typeof t[1]?t[3]:t[2]},new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}const r=e("/stat",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i);let o={};void 0!==n.uid?o.uid=n.uid:void 0!==n.path&&(o.path=zt(n.path)),o.return_subdomains=n.returnSubdomains,o.return_permissions=n.returnPermissions,o.return_versions=n.returnVersions,o.return_size=n.returnSize,r.send(JSON.stringify(o))}))},Rt=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}const r=e("/df",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i),r.send()}))},Ft=function(...t){let n={};return"string"==typeof t[0]&&"object"==typeof t[1]&&!(t[1]instanceof Function)||"object"==typeof t[0]&&null!==t[0]?"string"==typeof t[0]?(n.path=t[0],Object.assign(n,t[1]),n.success=t[2],n.error=t[3]):n=t[0]:"string"==typeof t[0]&&(n.path=t[0],n.success=t[1],n.error=t[2]),new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}const r=e("/mkdir",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i),n.path=zt(n.path),r.send(JSON.stringify({parent:Nt.dirname(n.path),path:Nt.basename(n.path),overwrite:n.overwrite??0,dedupe_name:(n.rename||n.dedupeName)??0,shortcut_to:n.shortcutTo,original_client_socket_id:this.socket.id,create_missing_parents:(n.recursive||n.createMissingParents)??0}))}))},Bt=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{source:t[0],destination:t[1],overwrite:t[2]?.overwrite,new_name:t[2]?.newName||t[2]?.new_name,create_missing_parents:t[2]?.createMissingParents||t[2]?.create_missing_parents,new_metadata:t[2]?.newMetadata||t[2]?.new_metadata,original_client_socket_id:t[2]?.excludeSocketID||t[2]?.original_client_socket_id,success:t[3],error:t[4]},new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}n.source=zt(n.source),n.destination=zt(n.destination);const r=e("/copy",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i),r.send(JSON.stringify({original_client_socket_id:this.socket.id,socket_id:this.socket.id,source:n.source,destination:n.destination,overwrite:n.overwrite,new_name:n.new_name||n.newName,dedupe_name:n.dedupe_name||n.dedupeName}))}))},Mt=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{path:t[0],new_name:t[1],success:t[2],error:t[3]},new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}const r=e("/rename",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i);let o={original_client_socket_id:n.excludeSocketID||n.original_client_socket_id,new_name:n.new_name||n.newName};void 0!==n.uid?o.uid=n.uid:void 0!==n.path&&(o.path=zt(n.path)),r.send(JSON.stringify(o))}))},qt=async function(e,n,i={}){return new Promise((async(s,r)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){r(t)}let o=new XMLHttpRequest;if("/"===n)return i.error&&"function"==typeof i.error&&i.error("Can not upload to root directory."),r("Can not upload to root directory.");n=zt(n);const a=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)));i.init&&"function"==typeof i.init&&i.init(a,o);let c,h=0,u=0,p=0,l=0;if(Array.isArray(e)&&e.length>0)for(let t=0;t<e.length;t++)(e[t]instanceof DataTransferItem||e[t]instanceof DataTransferItemList)&&(l=1);if(e instanceof DataTransferItemList||e instanceof DataTransferItem||e[0]instanceof DataTransferItem||i.parsedDataTransferItems)c=i.parsedDataTransferItems?e:await puter.ui.getEntriesFromDataTransferItems(e),c.sort(((t,e)=>t.isDirectory&&!e.isDirectory?-1:!t.isDirectory&&e.isDirectory?1:t.isDirectory&&e.isDirectory?0:t.size-e.size));else if(e instanceof File||e[0]instanceof File||e instanceof FileList||e[0]instanceof FileList){c=Array.isArray(e)?e:e instanceof FileList?Array.from(e):[e],c.sort(((t,e)=>t.size-e.size));for(let t=0;t<c.length;t++)c[t].filepath=c[t].name,c[t].fullPath=c[t].name}else if(e instanceof Blob){c=[new File([e],i.name,{type:"text/plain"})];for(let t=0;t<c.length;t++)c[t].filepath=c[t].name,c[t].fullPath=c[t].name}else if("string"==typeof e){c=[new File([e],"default.txt",{type:"text/plain"})];for(let t=0;t<c.length;t++)c[t].filepath=c[t].name,c[t].fullPath=c[t].name}let d,f=[],m=[];for(let t=0;t<c.length;t++)c[t]&&(c[t].isDirectory?f.push({path:Nt.join(n,c[t].finalPath?c[t].finalPath:c[t].fullPath)}):m.push(c[t]),void 0!==c[t].size&&(p+=c[t].size));if(0===f.length&&0===m.length)return i.error&&"function"==typeof i.error&&i.error({code:"EMPTY_UPLOAD",message:"No files or directories to upload."}),r({code:"EMPTY_UPLOAD",message:"No files or directories to upload."});if("web"!==puter.env)try{if(d=await this.space(),d.capacity-d.used<p)return i.error&&"function"==typeof i.error&&i.error({code:"NOT_ENOUGH_SPACE",message:"Not enough storage space available."}),r({code:"NOT_ENOUGH_SPACE",message:"Not enough storage space available."})}catch(t){}p*=2;const g=new FormData;f.sort();let b=[];for(let t=0;t<f.length;t++){for(let e=0;e<m.length;e++)!m[e].puter_path_param&&Nt.join(n,m[e].filepath).startsWith(f[t].path+"/")&&(m[e].puter_path_param=`$dir_${t}/`+Nt.basename(m[e].filepath));for(let e=0;e<f.length;e++)!f[e].puter_path_param&&f[e].path.startsWith(f[t].path+"/")&&(f[e].puter_path_param=`$dir_${t}/`+Nt.basename(f[e].path))}for(let t=0;t<f.length;t++){let e=Nt.dirname(f[t].puter_path_param||f[t].path),n=f[t].puter_path_param||f[t].path;"/"!==e&&(n=n.replace(e,"")),b.push({op:"mkdir",parent:e,path:n,overwrite:i.overwrite??0,dedupe_name:i.dedupeName??1,create_missing_ancestors:i.createMissingAncestors??1,as:`dir_${t}`})}b.reverse(),g.append("operation_id",a),g.append("socket_id",this.socket.id),g.append("original_client_socket_id",this.socket.id);for(let t=0;t<b.length;t++)g.append("operation",JSON.stringify(b[t]));if(!i.shortcutTo)for(let t=0;t<m.length;t++)g.append("fileinfo",JSON.stringify({name:m[t].name,type:m[t].type,size:m[t].size}));for(let t=0;t<m.length;t++)g.append("operation",JSON.stringify({op:i.shortcutTo?"shortcut":"write",dedupe_name:i.dedupeName??1,overwrite:i.overwrite??0,create_missing_ancestors:i.createMissingAncestors||i.createMissingParents,operation_id:a,path:m[t].puter_path_param&&Nt.dirname(m[t].puter_path_param??"")||m[t].filepath&&Nt.join(n,Nt.dirname(m[t].filepath))||"",name:Nt.basename(m[t].filepath),item_upload_id:t,shortcut_to:i.shortcutTo,shortcut_to_uid:i.shortcutTo,app_uid:i.appUID}));if(!i.shortcutTo)for(let t=0;t<m.length;t++)g.append("file",m[t]??"");const w=t=>{t.operation_id===a&&(u+=t.loaded_diff)};this.socket.on("upload.progress",w);let y=null;o.open("post",this.APIOrigin+"/batch",1),o.setRequestHeader("Authorization","Bearer "+this.authToken),o.upload.addEventListener("progress",(function(t){let e;null===y?(e=t.loaded,y=0):e=t.loaded-y,y+=e,h+=e;let n=((u+h)/p*100).toFixed(2);n=n>100?100:n,i.progress&&"function"==typeof i.progress&&i.progress(a,n)}));let v=setInterval((function(){let t=((u+h)/p*100).toFixed(2);t=t>100?100:t,i.progress&&"function"==typeof i.progress&&i.progress(a,t)}),100);o.onabort=()=>{clearInterval(v),this.socket.off("upload.progress",w),i.abort&&"function"==typeof i.abort&&i.abort(a)},o.onreadystatechange=async e=>{if(4===o.readyState){const e=await t(o);if(o.status>=400&&o.status<600||i.strict&&218===o.status){if(clearInterval(v),this.socket.off("upload.progress",w),i.strict&&218===o.status){let t;for(let n=0;n<e.results?.length;n++)if(200!==e.results[n].status){t=e.results[n];break}return i.error&&"function"==typeof i.error&&i.error(t),r(t)}return i.error&&"function"==typeof i.error&&i.error(e),r(e)}{e&&e.results&&e.results.length;let t=e.results;return t=1===t.length?t[0]:t,i.success&&"function"==typeof i.success&&i.success(t),clearInterval(v),this.socket.off("upload.progress",w),s(t)}}},i.start&&"function"==typeof i.start&&i.start(),o.send(g)}))},Wt=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{path:"string"==typeof t[0]?t[0]:"object"==typeof t[0]&&null!==t[0]?t[0].path:t[0],success:t[1],error:t[2]},new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}n.path=zt(n.path);const r=e("/read?file="+encodeURIComponent(n.path),this.APIOrigin,this.authToken,"get","application/json;charset=UTF-8","blob");s(r,n.success,n.error,t,i),r.send()}))},Jt=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{source:t[0],destination:t[1],overwrite:t[2]?.overwrite,new_name:t[2]?.newName||t[2]?.new_name,create_missing_parents:t[2]?.createMissingParents||t[2]?.create_missing_parents,new_metadata:t[2]?.newMetadata||t[2]?.new_metadata,original_client_socket_id:t[2]?.excludeSocketID||t[2]?.original_client_socket_id},new Promise((async(t,i)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){i("Authentication failed.")}n.source=zt(n.source),n.destination=zt(n.destination);const r=e("/move",this.APIOrigin,this.authToken);s(r,n.success,n.error,t,i),r.send(JSON.stringify({source:n.source,destination:n.destination,overwrite:n.overwrite,new_name:n.new_name||n.newName,create_missing_parents:n.create_missing_parents||n.createMissingParents,new_metadata:n.new_metadata||n.newMetadata,original_client_socket_id:n.excludeSocketID}))}))},Ht=async function(t,e,n={}){if(!t)throw new Error({code:"NO_TARGET_PATH",message:"No target path provided."});t instanceof File&&void 0===e&&(t=(e=t).name),n.strict=1,n.overwrite=n.overwrite??1,n.overwrite&&void 0===n.dedupeName&&(n.dedupeName=0),t=zt(t);const i=Nt.basename(t),s=Nt.dirname(t);return"string"==typeof e?e=new File([e??""],i??"Untitled.txt",{type:"text/plain"}):e instanceof Blob&&(e=new File([e??""],i??"Untitled",{type:e.type})),e||(e=new File([e??""],i)),this.upload(e,s,n)},Xt=function(...n){let s;return s={app_uid:n[0],items:n[1],success:n[2],error:n[3]},new Promise((async(n,r)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){r("Authentication failed.")}let o=s.items;Array.isArray(o)||(o=[o]);const a=e("/sign",this.APIOrigin,this.authToken);a.addEventListener("load",(async function(e){const i=await t(this);if(200!==this.status)return s.error&&"function"==typeof s.error&&s.error(i),r(i);{let t,e=i,r=e.token;if(1==o.length)t={...e.signatures[0]};else{let n=[];for(let t=0;t<e.signatures.length;t++)n.push({...e.signatures[t]});t=n}return s.success&&"function"==typeof s.success&&s.success({token:r,items:t}),n({token:r,items:t})}})),a.upload.addEventListener("progress",(function(t){})),a.addEventListener("error",(function(t){return i(s.error,r,this)})),a.send(JSON.stringify({app_uid:s.app_uid,items:o}))}))},Vt=async function(...t){let n;n="object"==typeof t[0]&&null!==t[0]?t[0]:{paths:t[0],recursive:t[1]?.recursive??1,descendantsOnly:t[1]?.descendantsOnly??0};let i=n.paths;return"string"==typeof i&&(i=[i]),new Promise((async(t,r)=>{if(!puter.authToken&&"web"===puter.env)try{await puter.ui.authenticateWithPuter()}catch(t){r("Authentication failed.")}const o=e("/delete",this.APIOrigin,this.authToken);s(o,n.success,n.error,t,r),i=i.map((t=>zt(t))),o.send(JSON.stringify({paths:i,descendants_only:(n.descendants_only||n.descendantsOnly)??0,recursive:n.recursive??1}))}))},Kt=class{readdir=$t;stat=Lt;space=Rt;mkdir=Ft;copy=Bt;rename=Mt;upload=qt;read=Wt;delete=Vt;move=Jt;write=Ht;sign=Xt;constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n,this.initializeSocket()}initializeSocket(){this.socket&&this.socket.disconnect(),this.socket=St(this.APIOrigin,{query:{auth_token:this.authToken}}),this.bindSocketEvents()}bindSocketEvents(){this.socket.on("connect",(()=>{})),this.socket.on("disconnect",(()=>{})),this.socket.on("reconnect",(t=>{})),this.socket.on("reconnect_attempt",(t=>{})),this.socket.on("reconnect_error",(t=>{})),this.socket.on("reconnect_failed",(()=>{})),this.socket.on("error",(t=>{}))}setAuthToken(t){this.authToken=t,this.initializeSocket()}setAPIOrigin(t){this.APIOrigin=t,this.initializeSocket()}},Yt=class{constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n}setAuthToken(t){this.authToken=t}setAPIOrigin(t){this.APIOrigin=t}list=a([],"puter-subdomains","select");create=async(...t)=>{let e={};return"string"==typeof t[0]&&1===t.length?(t[0].match(/^[a-z0-9]+\.puter\.(site|com)$/)&&(t[0]=t[0].split(".")[0]),e={object:{subdomain:t[0]}}):Array.isArray(t)&&2===t.length&&"string"==typeof t[0]?(t[0].match(/^[a-z0-9]+\.puter\.(site|com)$/)&&(t[0]=t[0].split(".")[0]),t[1]&&(t[1]=zt(t[1])),e={object:{subdomain:t[0],root_dir:t[1]}}):"object"==typeof t[0]&&(e={object:t[0]}),await a(["object"],"puter-subdomains","create").call(this,e)};update=async(...t)=>{let e={};return Array.isArray(t)&&"string"==typeof t[0]&&(t[0].match(/^[a-z0-9]+\.puter\.(site|com)$/)&&(t[0]=t[0].split(".")[0]),t[1]&&(t[1]=zt(t[1])),e={id:{subdomain:t[0]},object:{root_dir:t[1]??null}}),await a(["object"],"puter-subdomains","update").call(this,e)};get=async(...t)=>{let e={};return Array.isArray(t)&&"string"==typeof t[0]&&(t[0].match(/^[a-z0-9]+\.puter\.(site|com)$/)&&(t[0]=t[0].split(".")[0]),e={id:{subdomain:t[0]}}),a(["uid"],"puter-subdomains","read").call(this,e)};delete=async(...t)=>{let e={};return Array.isArray(t)&&"string"==typeof t[0]&&(t[0].match(/^[a-z0-9]+\.puter\.(site|com)$/)&&(t[0]=t[0].split(".")[0]),e={id:{subdomain:t[0]}}),a(["uid"],"puter-subdomains","delete").call(this,e)}},Gt=class{constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n}setAuthToken(t){this.authToken=t}setAPIOrigin(t){this.APIOrigin=t}list=async(...t)=>{let e={};return e={predicate:["user-can-edit"]},a(["uid"],"puter-apps","select").call(this,e)};create=async(...t)=>{let e={};if("string"==typeof t[0]){let n=t[1],i=t[2]??t[0];e={object:{name:t[0],index_url:n,title:i}}}else if("object"==typeof t[0]&&null!==t[0]){let n=t[0];e={object:{name:n.name,index_url:n.indexURL,title:n.title,description:n.description,icon:n.icon,maximize_on_start:n.maximizeOnStart,filetype_associations:n.filetypeAssociations}}}return await a(["object"],"puter-apps","create").call(this,e)};update=async(...t)=>{let e={};if(Array.isArray(t)&&"string"==typeof t[0]){let n=t[1],i={name:n.name,index_url:n.indexURL,title:n.title,description:n.description,icon:n.icon,maximize_on_start:n.maximizeOnStart,filetype_associations:n.filetypeAssociations};e={id:{name:t[0]},object:i}}return await a(["object"],"puter-apps","update").call(this,e)};get=async(...t)=>{let e={};return Array.isArray(t)&&"string"==typeof t[0]&&(e={id:{name:t[0]}}),a(["uid"],"puter-apps","read").call(this,e)};delete=async(...t)=>{let e={};return Array.isArray(t)&&"string"==typeof t[0]&&(e={id:{name:t[0]}}),a(["uid"],"puter-apps","delete").call(this,e)};getDeveloperProfile=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise(((n,i)=>{let r;return r="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise(((t,n)=>{const i=e("/get-dev-profile",puter.APIOrigin,puter.authToken,"get");s(i,r.success,r.error,t,n),i.send()}))}))}},Qt=class{constructor(t){this.readURL=t.readURL??t.read_url,this.writeURL=t.writeURL??t.write_url,this.metadataURL=t.metadataURL??t.metadata_url,this.name=t.name??t.fsentry_name,this.uid=t.uid??t.uuid??t.fsentry_uid??t.fsentry_id??t.fsentry_uuid??t.id,this.id=this.uid,this.uuid=this.uid,this.path=t.path??t.fsentry_path,this.size=t.size??t.fsentry_size,this.accessed=t.accessed??t.fsentry_accessed,this.modified=t.modified??t.fsentry_modified,this.created=t.created??t.fsentry_created,this.isDirectory=!!(t.isDirectory||t.is_dir||t.fsentry_is_dir)}write=async function(t){return puter.fs.write(this.path,new File([t],this.name),{overwrite:1,dedupeName:0})};watch=function(t){};open=function(t){};setAsWallpaper=function(t,e){};rename=function(t){return puter.fs.rename(this.uid,t)};move=function(t,e=0,n){return puter.fs.move(this.path,t,e,n)};copy=function(t,e=0,n=0){return puter.fs.copy(this.path,t,e,n)};delete=function(){return puter.fs.delete(this.path)};versions=async function(){};trash=function(){};mkdir=async function(t,e=0){if(!this.isDirectory)throw new Error("mkdir() can only be called on a directory");return puter.fs.mkdir(Nt.join(this.path,t))};metadata=async function(){};readdir=async function(){if(!this.isDirectory)throw new Error("readdir() can only be called on a directory");return puter.fs.readdir(this.path)};read=async function(){return puter.fs.read(this.path)}};var Zt=n(330),te=n.n(Zt);class ee{#t;#e;constructor(t){this.#t=t,this.#e=(()=>{const t=new Map;for(let e of this.#t)t[e]=[];return t})()}emit(t,e){this.#t.includes(t)&&this.#e[t].forEach((t=>{t(e)}))}on(t,e){this.#t.includes(t)&&this.#e[t].push(e)}off(t,e){if(!this.#t.includes(t))return;const n=this.#e[t],i=n.indexOf(e);-1!==i&&n.splice(i,1)}}class ne extends ee{#n="*";#i;constructor(t,e,n){super(["message","close"]),this.messageTarget=t,this.appInstanceID=e,this.targetAppInstanceID=n,this.#i=1,window.addEventListener("message",(t=>{if("messageToApp"===t.data.msg){if(t.data.appInstanceID!==this.targetAppInstanceID)return;return t.data.targetAppInstanceID!==this.appInstanceID?void 0:void this.emit("message",t.data.contents)}if("appClosed"===t.data.msg){if(t.data.appInstanceID!==this.targetAppInstanceID)return;this.#i=0,this.emit("close",{appInstanceID:this.targetAppInstanceID})}}))}postMessage(t){this.#i&&this.messageTarget.postMessage({msg:"messageToApp",appInstanceID:this.appInstanceID,targetAppInstanceID:this.targetAppInstanceID,targetAppOrigin:"*",contents:t},this.#n)}close(){this.#i&&this.messageTarget.postMessage({msg:"closeApp",appInstanceID:this.appInstanceID,targetAppInstanceID:this.targetAppInstanceID},this.#n)}}const ie=class extends ee{#s=1;itemWatchCallbackFunctions=[];appInstanceID;parentInstanceID;#r=null;#o=[];#a;#c;#h;#t;#u=new Map;#p=function(t,e,n={}){const i=this.#s++;this.messageTarget?.postMessage({msg:t,env:this.env,appInstanceID:this.appInstanceID,uuid:i,...n},"*"),this.#o[i]=e};constructor(t,e,n,i){const s=["localeChanged","themeChanged"];if(super(s),this.#t=s,this.appInstanceID=t,this.parentInstanceID=e,this.appID=n,this.env=i,"app"===this.env)this.messageTarget=window.parent;else if("gui"===this.env)return;this.parentInstanceID&&(this.#r=new ne(this.messageTarget,this.appInstanceID,this.parentInstanceID)),this.messageTarget?.postMessage({msg:"READY",appInstanceID:this.appInstanceID},"*"),window.addEventListener("focus",(t=>{this.messageTarget?.postMessage({msg:"windowFocused",appInstanceID:this.appInstanceID},"*")}));let r=null;window.addEventListener("message",(async t=>{if(t.data.error)throw t.data.error;if(t.data.msg&&"focus"===t.data.msg)window.focus();else if(t.data.msg&&"click"===t.data.msg){const e=document.elementFromPoint(t.data.x,t.data.y);null!==e&&e.click()}else if(t.data.msg&&"drag"===t.data.msg){const e=document.elementFromPoint(t.data.x,t.data.y);if(e!==r){if(r){const e=new Event("dragleave",{bubbles:1,cancelable:1,clientX:t.data.x,clientY:t.data.y});r.dispatchEvent(e)}if(e){const n=new Event("dragenter",{bubbles:1,cancelable:1,clientX:t.data.x,clientY:t.data.y});e.dispatchEvent(n)}r=e}}else if(t.data.msg&&"drop"===t.data.msg){if(r){const e=new CustomEvent("drop",{bubbles:1,cancelable:1,detail:{clientX:t.data.x,clientY:t.data.y,items:t.data.items}});r.dispatchEvent(e),r=null}}else if("windowWillClose"===t.data.msg)void 0===this.#a?this.messageTarget?.postMessage({msg:1,appInstanceID:this.appInstanceID,original_msg_id:t.data.msg_id},"*"):(this.messageTarget?.postMessage({msg:0,appInstanceID:this.appInstanceID,original_msg_id:t.data.msg_id},"*"),this.#a());else if("itemsOpened"===t.data.msg)if(void 0===this.#c)this.messageTarget?.postMessage({msg:1,appInstanceID:this.appInstanceID,original_msg_id:t.data.msg_id},"*");else{this.messageTarget?.postMessage({msg:0,appInstanceID:this.appInstanceID,original_msg_id:t.data.msg_id},"*");let e=[];if(t.data.items.length>0)for(let n=0;n<t.data.items.length;n++)e.push(new Qt(t.data.items[n]));this.#c(e)}else if("getAppDataSucceeded"===t.data.msg){let e=new Qt(t.data.item);t.data.original_msg_id&&this.#o[t.data.original_msg_id]&&this.#o[t.data.original_msg_id](e)}else if("readAppDataFileSucceeded"===t.data.msg){let e=new Qt(t.data.item);t.data.original_msg_id&&this.#o[t.data.original_msg_id]&&this.#o[t.data.original_msg_id](e)}else if("readAppDataFileFailed"===t.data.msg)t.data.original_msg_id&&this.#o[t.data.original_msg_id]&&this.#o[t.data.original_msg_id](null);else if(t.data.original_msg_id&&this.#o[t.data.original_msg_id]){if("fileOpenPicked"===t.data.msg){if(1===t.data.items.length)this.#o[t.data.original_msg_id](new Qt(t.data.items[0]));else if(t.data.items.length>1){let e=[];for(let n=0;n<t.data.items.length;n++)e.push(new Qt(t.data.items[n]));this.#o[t.data.original_msg_id](e)}}else if("directoryPicked"===t.data.msg){if(1===t.data.items.length)this.#o[t.data.original_msg_id](new Qt({uid:t.data.items[0].uid,name:t.data.items[0].fsentry_name,path:t.data.items[0].path,readURL:t.data.items[0].read_url,writeURL:t.data.items[0].write_url,metadataURL:t.data.items[0].metadata_url,isDirectory:1,size:t.data.items[0].fsentry_size,accessed:t.data.items[0].fsentry_accessed,modified:t.data.items[0].fsentry_modified,created:t.data.items[0].fsentry_created}));else if(t.data.items.length>1){let e=[];for(let n=0;n<t.data.items.length;n++)e.push(new Qt(t.data.items[n]));this.#o[t.data.original_msg_id](e)}}else if("colorPicked"===t.data.msg)this.#o[t.data.original_msg_id](t.data.color);else if("fontPicked"===t.data.msg)this.#o[t.data.original_msg_id](t.data.font);else if("alertResponded"===t.data.msg)this.#o[t.data.original_msg_id](t.data.response);else if("promptResponded"===t.data.msg)this.#o[t.data.original_msg_id](t.data.response);else if("fileSaved"===t.data.msg)this.#o[t.data.original_msg_id](new Qt(t.data.saved_file));else if("childAppLaunched"===t.data.msg){const e=new ne(this.messageTarget,this.appInstanceID,t.data.child_instance_id);this.#o[t.data.original_msg_id](e)}else this.#o[t.data.original_msg_id](t.data);delete this.#o[t.data.original_msg_id]}else if("itemChanged"===t.data.msg&&t.data.data&&t.data.data.uid)itemWatchCallbackFunctions[t.data.data.uid]&&"function"==typeof itemWatchCallbackFunctions[t.data.data.uid]&&itemWatchCallbackFunctions[t.data.data.uid](t.data.data);else if("broadcast"===t.data.msg){const{name:e,data:n}=t.data;if(!this.#t.includes(e))return;this.emit(e,n),this.#u.set(e,n)}}))}onWindowClose=function(t){this.#a=t};onItemsOpened=function(t){if(!this.#c){let e=new URLSearchParams(window.location.search);if(e.has("puter.item.name")&&e.has("puter.item.uid")&&e.has("puter.item.read_url")){let n=e.get("puter.item.path");n="~/"+n.split("/").slice(2).join("/"),t([new Qt({name:e.get("puter.item.name"),path:n,uid:e.get("puter.item.uid"),readURL:e.get("puter.item.read_url"),writeURL:e.get("puter.item.write_url"),metadataURL:e.get("puter.item.metadata_url"),size:e.get("puter.item.size"),accessed:e.get("puter.item.accessed"),modified:e.get("puter.item.modified"),created:e.get("puter.item.created")})])}}this.#c=t};onLaunchedWithItems=function(t){if(!this.#h){let e=new URLSearchParams(window.location.search);if(e.has("puter.item.name")&&e.has("puter.item.uid")&&e.has("puter.item.read_url")){let n=e.get("puter.item.path");n="~/"+n.split("/").slice(2).join("/"),t([new Qt({name:e.get("puter.item.name"),path:n,uid:e.get("puter.item.uid"),readURL:e.get("puter.item.read_url"),writeURL:e.get("puter.item.write_url"),metadataURL:e.get("puter.item.metadata_url"),size:e.get("puter.item.size"),accessed:e.get("puter.item.accessed"),modified:e.get("puter.item.modified"),created:e.get("puter.item.created")})])}}this.#h=t};alert=function(t,e,n,i){return new Promise((i=>{this.#p("ALERT",i,{message:t,buttons:e,options:n})}))};prompt=function(t,e,n,i){return new Promise((i=>{this.#p("PROMPT",i,{message:t,placeholder:e,options:n})}))};showDirectoryPicker=function(t,e){return new Promise((e=>{const n=this.#s++;if("app"===this.env)this.messageTarget?.postMessage({msg:"showDirectoryPicker",appInstanceID:this.appInstanceID,uuid:n,options:t,env:this.env},"*");else{let e=700,r=400,o="Puter: Open Directory";var i=screen.width/2-e/2,s=screen.height/2-r/2;window.open(`${puter.defaultGUIOrigin}/action/show-directory-picker?embedded_in_popup=true&msg_id=${n}&appInstanceID=${this.appInstanceID}&env=${this.env}&options=${JSON.stringify(t)}`,o,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+e+", height="+r+", top="+s+", left="+i)}this.#o[n]=e}))};showOpenFilePicker=function(t,e){return new Promise((e=>{const n=this.#s++;if("app"===this.env)this.messageTarget?.postMessage({msg:"showOpenFilePicker",appInstanceID:this.appInstanceID,uuid:n,options:t??{},env:this.env},"*");else{let e=700,r=400,o="Puter: Open File";var i=screen.width/2-e/2,s=screen.height/2-r/2;window.open(`${puter.defaultGUIOrigin}/action/show-open-file-picker?embedded_in_popup=true&msg_id=${n}&appInstanceID=${this.appInstanceID}&env=${this.env}&options=${JSON.stringify(t??{})}`,o,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+e+", height="+r+", top="+s+", left="+i)}this.#o[n]=e}))};showFontPicker=function(t){return new Promise((e=>{this.#p("showFontPicker",e,{options:t??{}})}))};showColorPicker=function(t){return new Promise((e=>{this.#p("showColorPicker",e,{options:t??{}})}))};showSaveFilePicker=function(t,e){return new Promise((n=>{const i=this.#s++,s="[object URL]"===Object.prototype.toString.call(t)?t:void 0;if("app"===this.env)this.messageTarget?.postMessage({msg:"showSaveFilePicker",appInstanceID:this.appInstanceID,content:s?void 0:t,url:s?s.toString():void 0,suggestedName:e??"",env:this.env,uuid:i},"*");else{window.addEventListener("message",(async n=>{"sendMeFileData"===n.data?.msg&&(n.source.postMessage({msg:"showSaveFilePickerPopup",content:s?void 0:t,url:s?s.toString():void 0,suggestedName:e??"",env:this.env,uuid:i},"*"),window.removeEventListener("message",this))}));let n=new Blob([t],{type:"application/octet-stream"}),a=URL.createObjectURL(n),c=700,h=400,u="Puter: Save File";var r=screen.width/2-c/2,o=screen.height/2-h/2;window.open(`${puter.defaultGUIOrigin}/action/show-save-file-picker?embedded_in_popup=true&msg_id=${i}&appInstanceID=${this.appInstanceID}&env=${this.env}&blobUrl=${encodeURIComponent(a)}`,u,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+c+", height="+h+", top="+o+", left="+r)}this.#o[i]=n}))};setWindowTitle=function(t,e){return new Promise((e=>{this.#p("setWindowTitle",e,{new_title:t})}))};setWindowWidth=function(t,e){return new Promise((e=>{this.#p("setWindowWidth",e,{width:t})}))};setWindowHeight=function(t,e){return new Promise((e=>{this.#p("setWindowHeight",e,{height:t})}))};setWindowSize=function(t,e,n){return new Promise((n=>{this.#p("setWindowSize",n,{width:t,height:e})}))};setWindowPosition=function(t,e,n){return new Promise((n=>{this.#p("setWindowPosition",n,{x:t,y:e})}))};getEntriesFromDataTransferItems=async function(t,e={raw:0}){const n=t=>{this.getEntriesFromDataTransferItems.didShowInfo||"EncodingError"===t.name&&(this.getEntriesFromDataTransferItems.didShowInfo=1,t.name,t.message)},i=(t,e)=>new Promise(((i,r)=>{t.readEntries((async t=>{let n=[];for(let i of t){const t=await s(i,e);n=n.concat(t)}i(n)}),(t=>{n(t),r(t)}))})),s=async(t,s="")=>{if(null!==t){if(t.isFile){const i=await((t,i="")=>new Promise(((s,r)=>{t.file((t=>{e.raw||(t.filepath=i+t.name),s(t)}),(t=>{n(t),r(t)}))})))(t,s);return[i]}if(t.isDirectory){const e=await(async(t,e)=>{const n=t.createReader(),s=e+t.name+"/";let r,o=[];do{r=await i(n,s),o=o.concat(r)}while(r.length>0);return o})(t,s);return e.push(t),e}}};let r=[],o=[];for(let e=0,n=t.length;e<n;e++)o.push(t[e].webkitGetAsEntry());for(let t of o){const e=await s(t);r=r.concat(e)}return r};authenticateWithPuter=function(){if("web"===this.env)return this.authToken?new Promise((t=>{t()})):puter.puterAuthState.isPromptOpen?new Promise(((t,e)=>{puter.puterAuthState.resolver={resolve:t,reject:e}})):(puter.puterAuthState.isPromptOpen=1,puter.puterAuthState.authGranted=null,new Promise(((t,e)=>{if(puter.authToken)t();else{const n=new(te())(t,e);document.body.appendChild(n),n.open()}})))};launchApp=function(t,e,n){return new Promise((n=>{"object"!=typeof t||e||(e=t,t=void 0),this.#p("launchApp",n,{app_name:t,args:e})}))};parentApp(){return this.#r}createWindow=function(t,e){return new Promise((e=>{this.#p("createWindow",e,{options:t??{}})}))};menubar=function(){document.querySelectorAll("style.puter-stylesheet").forEach((function(t){t.remove()}));const t=document.createElement("style");t.classList.add("puter-stylesheet"),t.innerHTML="\n        .--puter-menubar {\n            border-bottom: 1px solid #e9e9e9;\n            background-color: #fbf9f9;\n            padding-top: 3px;\n            padding-bottom: 2px;\n            display: inline-block;\n            position: fixed;\n            top: 0;\n            width: 100%;\n            margin: 0;\n            padding: 0;\n            height: 31px;\n            font-family: Arial, Helvetica, sans-serif;\n            font-size: 13px;\n            z-index: 9999;\n        }\n        \n        .--puter-menubar, .--puter-menubar * {\n            user-select: none;\n            -webkit-user-select: none;\n            cursor: default;\n        }\n        \n        .--puter-menubar .dropdown-item-divider>hr {\n            margin-top: 5px;\n            margin-bottom: 5px;\n            border-bottom: none;\n            border-top: 1px solid #00000033;\n        }\n        \n        .--puter-menubar>li {\n            display: inline-block;\n            padding: 10px 5px;\n        }\n        \n        .--puter-menubar>li>ul {\n            display: none;\n            z-index: 999999999999;\n            list-style: none;\n            background-color: rgb(233, 233, 233);\n            width: 200px;\n            border: 1px solid #e4ebf3de;\n            box-shadow: 0px 0px 5px #00000066;\n            padding-left: 6px;\n            padding-right: 6px;\n            padding-top: 4px;\n            padding-bottom: 4px;\n            color: #333;\n            border-radius: 4px;\n            padding: 2px;\n            min-width: 200px;\n            margin-top: 5px;\n            position: absolute;\n        }\n        \n        .--puter-menubar .menubar-item {\n            display: block;\n            line-height: 24px;\n            margin-top: -7px;\n            text-align: center;\n            border-radius: 3px;\n            padding: 0 5px;\n        }\n        \n        .--puter-menubar .menubar-item-open {\n            background-color: rgb(216, 216, 216);\n        }\n        \n        .--puter-menubar .dropdown-item {\n            padding: 5px;\n            padding: 5px 30px;\n            list-style-type: none;\n            user-select: none;\n            font-size: 13px;\n        }\n        \n        .--puter-menubar .dropdown-item-icon, .--puter-menubar .dropdown-item-icon-active {\n            pointer-events: none;\n            width: 18px;\n            height: 18px;\n            margin-left: -23px;\n            margin-bottom: -4px;\n            margin-right: 5px;\n        }\n        .--puter-menubar .dropdown-item-disabled .dropdown-item-icon{\n            display: inline-block !important;\n        }\n        .--puter-menubar .dropdown-item-disabled .dropdown-item-icon-active{\n            display: none !important;\n        }\n        .--puter-menubar .dropdown-item-icon-active {\n            display:none;\n        }\n        .--puter-menubar .dropdown-item:hover .dropdown-item-icon{\n            display: none;\n        }\n        .--puter-menubar .dropdown-item:hover .dropdown-item-icon-active{\n            display: inline-block;\n        }\n        .--puter-menubar .dropdown-item-hide-icon .dropdown-item-icon, .--puter-menubar .dropdown-item-hide-icon .dropdown-item-icon-active{\n            display: none !important;\n        }\n        .--puter-menubar .dropdown-item a {\n            color: #333;\n            text-decoration: none;\n        }\n        \n        .--puter-menubar .dropdown-item:hover, .--puter-menubar .dropdown-item:hover a {\n            background-color: rgb(59 134 226);\n            color: white;\n            border-radius: 4px;\n        }\n        \n        .--puter-menubar .dropdown-item-disabled, .--puter-menubar .dropdown-item-disabled:hover {\n            opacity: 0.5;\n            background-color: transparent;\n            color: initial;\n            cursor: initial;\n            pointer-events: none;\n        }\n        \n        .--puter-menubar .menubar * {\n            user-select: none;\n        }                \n        ",(document.head||document.getElementsByTagName("head")[0]).appendChild(t),document.addEventListener("click",(function(t){if(t.target.classList.contains("dropdown-item-disabled"))return 0;t.target.classList.contains("menubar-item")||(document.querySelectorAll(".menubar-item.menubar-item-open").forEach((function(t){t.classList.remove("menubar-item-open")})),document.querySelectorAll(".dropdown").forEach((t=>t.style.display="none")))})),window.addEventListener("blur",(function(t){document.querySelectorAll(".dropdown").forEach((function(t){t.style.display="none"})),document.querySelectorAll(".menubar-item.menubar-item-open").forEach((t=>t.classList.remove("menubar-item-open")))})),document.querySelectorAll(".menubar-item").forEach((t=>t.addEventListener("mousedown",(function(t){document.querySelectorAll(".dropdown").forEach((function(t){t.style.display="none"})),document.querySelectorAll(".menubar-item.menubar-item-open").forEach((function(e){e!=t.target&&e.classList.remove("menubar-item-open")})),this.classList.contains("menubar-item-open")?document.querySelectorAll(".menubar-item.menubar-item-open").forEach((function(t){t.classList.remove("menubar-item-open")})):t.target.classList.contains("dropdown-item")||(this.classList.add("menubar-item-open"),function(t){const e=[];if(!t.parentNode)return e;let n=t.parentNode.firstChild;for(;n;)1===n.nodeType&&n!==t&&e.push(n),n=n.nextSibling;return e}(this).forEach((function(t){t.style.display="block"})))})))),document.querySelectorAll(".--puter-menubar .menubar-item").forEach((t=>t.addEventListener("mouseover",(function(t){const e=document.querySelectorAll(".menubar-item.menubar-item-open");e.length>0&&e[0]!==t.target&&t.target.dispatchEvent(new Event("mousedown"))}))))};on(t,e){super.on(t,e),this.#t.includes(t)&&this.#u.has(t)&&e(this.#u.get(t))}};function se(t,e){let n=(i=t,i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).replace(/\\\*/g,".*").replace(/\\\?/g,".").replace(/\\\[/g,"[").replace(/\\\]/g,"]").replace(/\\\^/g,"^");var i;return new RegExp("^"+n+"$").test(e)}const re=class{MAX_KEY_SIZE=1024;MAX_VALUE_SIZE=409600;constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n}setAuthToken(t){this.authToken=t}setAPIOrigin(t){this.APIOrigin=t}set=a(["key","value"],"puter-kvstore","set",{preprocess:t=>{if(void 0===t.key||null===t.key)throw{message:"Key cannot be undefined",code:"key_undefined"};if(t.key.length>this.MAX_KEY_SIZE)throw{message:"Key size cannot be larger than "+this.MAX_KEY_SIZE,code:"key_too_large"};if(t.value&&t.value.length>this.MAX_VALUE_SIZE)throw{message:"Value size cannot be larger than "+this.MAX_VALUE_SIZE,code:"value_too_large"};return t}});get=a(["key"],"puter-kvstore","get",{preprocess:t=>{if(t.key.length>this.MAX_KEY_SIZE)throw{message:"Key size cannot be larger than "+this.MAX_KEY_SIZE,code:"key_too_large"};return t},transform:t=>t});incr=async(...t)=>{let e={};if(!t||0===t.length)throw{message:"Arguments are required",code:"arguments_required"};if(e.key=t[0],e.amount=t[1]??1,e.key.length>this.MAX_KEY_SIZE)throw{message:"Key size cannot be larger than "+this.MAX_KEY_SIZE,code:"key_too_large"};return a(["key"],"puter-kvstore","incr").call(this,e)};decr=async(...t)=>{let e={};if(!t||0===t.length)throw{message:"Arguments are required",code:"arguments_required"};if(e.key=t[0],e.amount=t[1]??1,e.key.length>this.MAX_KEY_SIZE)throw{message:"Key size cannot be larger than "+this.MAX_KEY_SIZE,code:"key_too_large"};return a(["key"],"puter-kvstore","decr").call(this,e)};del=a(["key"],"puter-kvstore","del",{preprocess:t=>{if(t.key.length>this.MAX_KEY_SIZE)throw{message:"Key size cannot be larger than "+this.MAX_KEY_SIZE,code:"key_too_large"};return t}});list=async(...t)=>{let e,n={},i=0;return t&&1===t.length&&1==t[0]||t&&2===t.length&&1==t[1]?(n={},i=1):n={as:"keys"},(t&&1===t.length&&"string"==typeof t[0]||t&&2===t.length&&"string"==typeof t[0]&&1==t[1])&&(e=t[0]),a([],"puter-kvstore","list",{transform:t=>e?i?t.filter((t=>se(e,t.key))):t.filter((t=>se(e,t))):t}).call(this,n)};flush=a([],"puter-kvstore","flush");clear=this.flush},oe=class{constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n}setAuthToken(t){this.authToken=t}setAPIOrigin(t){this.APIOrigin=t}img2txt=async(...t)=>{let e={},n=0;if(!t)throw{message:"Arguments are required",code:"arguments_required"};if(("string"==typeof t[0]||t[0]instanceof Blob)&&(e.source=t[0]),t[0].source instanceof Blob&&(e.source=await p(t[0].source)),e.source.length>this.MAX_INPUT_SIZE)throw{message:"Input size cannot be larger than 10485760",code:"input_too_large"};return("boolean"==typeof t[1]&&1==t[1]||"boolean"==typeof t[2]&&1==t[2]||"boolean"==typeof t[3]&&1==t[3])&&(n=1),await a(["source"],"puter-ocr","recognize",{test_mode:n??0,transform:async t=>{let e="";for(let n=0;n<t?.blocks?.length;n++)"text/textract:LINE"===t.blocks[n].type&&(e+=t.blocks[n].text+"\n");return e}}).call(this,e)};txt2speech=async(...t)=>{let e={},n=0;if(!t)throw{message:"Arguments are required",code:"arguments_required"};if("string"==typeof t[0]&&(e={text:t[0]}),t[1]&&"string"==typeof t[1]&&(e.language=t[1]),e.text.length>this.MAX_INPUT_SIZE)throw{message:"Input size cannot be larger than 3000",code:"input_too_large"};return("boolean"==typeof t[1]&&1==t[1]||"boolean"==typeof t[2]&&1==t[2]||"boolean"==typeof t[3]&&1==t[3])&&(n=1),await a(["source"],"puter-tts","synthesize",{responseType:"blob",test_mode:n??0,transform:async t=>{const e=await u(t),n=new Audio(e);return n.toString=()=>e,n.valueOf=()=>e,n}}).call(this,e)};chat=async(...t)=>{let e={},n=0;if(!t)throw{message:"Arguments are required",code:"arguments_required"};if("string"!=typeof t[0]||t[1]&&"boolean"!=typeof t[1])if("string"==typeof t[0]&&("string"==typeof t[1]||t[1]instanceof File))t[1]instanceof File&&(t[1]=await p(t[1])),e={vision:1,messages:[{content:[t[0],{image_url:{url:t[1]}}]}]};else if("string"==typeof t[0]&&Array.isArray(t[1])){for(let e=0;e<t[1].length;e++)t[1][e]={image_url:{url:t[1][e]}};e={vision:1,messages:[{content:[t[0],...t[1]]}]}}else Array.isArray(t[0])&&(e={messages:t[0]});else e={messages:[{content:t[0]}]};return("boolean"==typeof t[1]&&1==t[1]||"boolean"==typeof t[2]&&1==t[2]||"boolean"==typeof t[3]&&1==t[3])&&(n=1),await a(["messages"],"puter-chat-completion","complete",{test_mode:n??0,transform:async t=>(t.toString=()=>t.message?.content,t.valueOf=()=>t.message?.content,t)}).call(this,e)};txt2img=async(...t)=>{let e={},n=0;if(!t)throw{message:"Arguments are required",code:"arguments_required"};return"string"==typeof t[0]&&(e={prompt:t[0]}),"boolean"==typeof t[1]&&1==t[1]&&(n=1),await a(["prompt"],"puter-image-generation","generate",{responseType:"blob",test_mode:n??0,transform:async t=>{let e=new Image;return e.src=await u(t),e.toString=()=>e.src,e.valueOf=()=>e.src,e}}).call(this,e)}},ae=class{#s=1;constructor(t,e,n){this.authToken=t,this.APIOrigin=e,this.appID=n}setAuthToken(t){this.authToken=t}setAPIOrigin(t){this.APIOrigin=t}signIn=()=>new Promise(((t,e)=>{let n=this.#s++;var i=screen.width/2-300,s=screen.height/2-300;window.open(puter.defaultGUIOrigin+"/action/sign-in?embedded_in_popup=true&msg_id="+n,"Puter","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=600, top="+s+", left="+i),window.addEventListener("message",(function(i){i.data.msg_id==n&&(delete i.data.msg_id,delete i.data.msg,i.data.success?(puter.setAuthToken(i.data.token),t(i.data)):e(i.data),window.removeEventListener("message",this))}))}));isSignedIn=()=>!!puter.authToken;getUser=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise(((t,i)=>{const r=e("/whoami",puter.APIOrigin,puter.authToken,"get");s(r,n.success,n.error,t,i),r.send()}))};signOut=()=>{puter.resetAuthToken()}};window.puter=new class{env;defaultAPIOrigin="https://api.puter.com";defaultGUIOrigin="https://puter.com";onAuth;puterAuthState={isPromptOpen:0,authGranted:null,resolver:null};appInstanceID;parentInstanceID;static FSItem=Qt;eventHandlers={};constructor(t){t=t??{};let e=new URLSearchParams(window.location.search);if(e.has("puter.app_instance_id")?this.env="app":1==window.puter_gui_enabled?this.env="gui":this.env="web","puter.com"===window.location.hostname&&(this.env="gui"),e.has("puter.args")?this.args=JSON.parse(decodeURIComponent(e.get("puter.args"))):this.args={},e.has("puter.app_instance_id")&&(this.appInstanceID=decodeURIComponent(e.get("puter.app_instance_id"))),e.has("puter.parent_instance_id")&&(this.parentInstanceID=decodeURIComponent(e.get("puter.parent_instance_id"))),e.has("puter.app.id")&&(this.appID=decodeURIComponent(e.get("puter.app.id"))),this.appID&&(this.appDataPath=`~/AppData/${this.appID}`),this.APIOrigin=this.defaultAPIOrigin,e.has("puter.api_origin")?this.APIOrigin=decodeURIComponent(e.get("puter.api_origin")):e.has("puter.domain")&&(this.APIOrigin="https://api."+e.get("puter.domain")),"gui"===this.env)this.authToken=window.auth_token,this.initSubmodules();else if("app"===this.env){this.authToken=decodeURIComponent(e.get("puter.auth.token")),this.initSubmodules();try{localStorage.getItem("puter.auth.token")&&this.setAuthToken(localStorage.getItem("puter.auth.token")),localStorage.getItem("puter.app.id")&&this.setAppID(localStorage.getItem("puter.app.id"))}catch(t){}}else if("web"===this.env){this.initSubmodules();try{localStorage.getItem("puter.auth.token")&&this.setAuthToken(localStorage.getItem("puter.auth.token")),localStorage.getItem("puter.app.id")&&this.setAppID(localStorage.getItem("puter.app.id"))}catch(t){}}}initSubmodules=function(){this.auth=new ae(this.authToken,this.APIOrigin,this.appID,this.env),this.os=new l(this.authToken,this.APIOrigin,this.appID,this.env),this.fs=new Kt(this.authToken,this.APIOrigin,this.appID,this.env),this.ui=new ie(this.appInstanceID,this.parentInstanceID,this.appID,this.env),this.hosting=new Yt(this.authToken,this.APIOrigin,this.appID,this.env),this.apps=new Gt(this.authToken,this.APIOrigin,this.appID,this.env),this.ai=new oe(this.authToken,this.APIOrigin,this.appID,this.env),this.kv=new re(this.authToken,this.APIOrigin,this.appID,this.env),this.path=Nt};updateSubmodules(){[this.os,this.fs,this.hosting,this.apps,this.ai,this.kv].forEach((t=>{t&&(t.setAuthToken(this.authToken),t.setAPIOrigin(this.APIOrigin))}))}setAppID=function(t){try{localStorage.setItem("puter.app.id",t)}catch(t){}this.appID=t};setAuthToken=function(t){if(this.authToken=t,"web"===this.env||"app"===this.env)try{localStorage.setItem("puter.auth.token",t)}catch(t){}this.updateSubmodules()};setAPIOrigin=function(t){this.APIOrigin=t,this.updateSubmodules()};resetAuthToken=function(){if(this.authToken=null,"web"===this.env||"app"===this.env)try{localStorage.removeItem("puter.auth.token")}catch(t){}this.updateSubmodules()};exit=function(){window.parent.postMessage({msg:"exit",appInstanceID:this.appInstanceID},"*")};randName=function(t="-"){const e=["helpful","sensible","loyal","honest","clever","capable","calm","smart","genius","bright","charming","creative","diligent","elegant","fancy","colorful","avid","active","gentle","happy","intelligent","jolly","kind","lively","merry","nice","optimistic","polite","quiet","relaxed","silly","victorious","witty","young","zealous","strong","brave","agile","bold"],n=["street","roof","floor","tv","idea","morning","game","wheel","shoe","bag","clock","pencil","pen","magnet","chair","table","house","dog","room","book","car","cat","tree","flower","bird","fish","sun","moon","star","cloud","rain","snow","wind","mountain","river","lake","sea","ocean","island","bridge","road","train","plane","ship","bicycle","horse","elephant","lion","tiger","bear","zebra","giraffe","monkey","snake","rabbit","duck","goose","penguin","frog","crab","shrimp","whale","octopus","spider","ant","bee","butterfly","dragonfly","ladybug","snail","camel","kangaroo","koala","panda","piglet","sheep","wolf","fox","deer","mouse","seal","chicken","cow","dinosaur","puppy","kitten","circle","square","garden","otter","bunny","meerkat","harp"];return e[Math.floor(Math.random()*e.length)]+t+n[Math.floor(Math.random()*n.length)]+t+Math.floor(1e4*Math.random())};getUser=function(...t){let n;return n="object"==typeof t[0]&&null!==t[0]?t[0]:{success:t[0],error:t[1]},new Promise(((t,i)=>{const r=e("/whoami",this.APIOrigin,this.authToken,"get");s(r,n.success,n.error,t,i),r.send()}))};print=function(...t){for(let e of t)document.getElementsByTagName("body")[0].append(e)}},window.addEventListener("message",(async t=>{t.origin===puter.defaultGUIOrigin&&(t.data.msg&&"requestOrigin"===t.data.msg?t.source.postMessage({msg:"originResponse"},"*"):"puter.token"===t.data.msg&&(puter.setAuthToken(t.data.token),puter.setAppID(t.data.app_uid),puter.puterAuthState.authGranted=1,puter.onAuth&&"function"==typeof puter.onAuth&&puter.getUser().then((t=>{puter.onAuth(t)})),puter.puterAuthState.isPromptOpen=0,puter.puterAuthState.resolver&&(puter.puterAuthState.authGranted?puter.puterAuthState.resolver.resolve():puter.puterAuthState.resolver.reject(),puter.puterAuthState.resolver=null)))}))})()})();
